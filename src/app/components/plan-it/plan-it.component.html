<div class="plan-it-container">
  <div class="plan-it-header">
    <button
      mat-button
      color="primary"
      (click)="toggleArchivedTasks()"
      [matTooltip]="showArchived ? 'Hide archived tasks' : 'Show archived tasks'"
    >
      <mat-icon>{{ showArchived ? 'visibility_off' : 'visibility' }}</mat-icon>
      {{ showArchived ? 'Hide Archived' : 'Show Archived' }}
    </button>
  </div>

  @if (!hasAnyTasks()) {
    <div class="no-tasks-message">
      <mat-icon>info</mat-icon>
      <p>No tasks available</p>
    </div>
  }

  @if (hasAnyTasks()) {
    <div class="columns-container">
      <div class="column">
        <h2>To Do</h2>
        <div class="task-list">
          @if (todoTasks.length === 0) {
            <div class="empty-column-message">
              <p>No tasks to do</p>
            </div>
          }
          @for (task of todoTasks; track task.id) {
            <app-task-card
              [task]="task"
              (startTask)="onStartTask($event)"
              (completeTask)="onCompleteTask($event)"
              (archiveTask)="onArchiveTask($event)"
              (reopenTask)="onReopenTask($event)"
              (printTask)="onPrintTask($event)"
              (editTask)="onEditTask($event)"
            >
            </app-task-card>
          }
        </div>
      </div>

      <div class="column">
        <h2>In Progress</h2>
        <div class="task-list">
          @if (inProgressTasks.length === 0) {
            <div class="empty-column-message">
              <p>No tasks in progress</p>
            </div>
          }
          @for (task of inProgressTasks; track task.id) {
            <app-task-card
              [task]="task"
              (startTask)="onStartTask($event)"
              (completeTask)="onCompleteTask($event)"
              (archiveTask)="onArchiveTask($event)"
              (reopenTask)="onReopenTask($event)"
              (printTask)="onPrintTask($event)"
            >
            </app-task-card>
          }
        </div>
      </div>

      <div class="column">
        <h2>Done</h2>
        <div class="task-list">
          @if (doneTasks.length === 0) {
            <div class="empty-column-message">
              <p>No completed tasks</p>
            </div>
          }
          @for (task of doneTasks; track task.id) {
            <app-task-card
              [task]="task"
              (archiveTask)="onArchiveTask($event)"
              (reopenTask)="onReopenTask($event)"
              (printTask)="onPrintTask($event)"
            >
            </app-task-card>
          }
        </div>
      </div>

      @if (showArchived) {
        <div class="column">
          <h2>Archived</h2>
          <div class="task-list">
            @if (archivedTasks.length === 0) {
              <div class="empty-column-message">
                <p>No archived tasks</p>
              </div>
            }
            @for (task of archivedTasks; track task.id) {
              <app-task-card [task]="task" [showActions]="false" (printTask)="onPrintTask($event)">
              </app-task-card>
            }
          </div>
        </div>
      }
    </div>
  }
</div>
