# Taskmanagement-frontend (.windsurfrules)

## Project identity

- Frontend only: Angular 19 app. Backend is Python and is out of scope for this repo.
- Angular style: standalone bootstrap (src/main.ts) + ApplicationConfig providers (src/app/app.config.ts).
- UI library: Angular Material (prebuilt theme azure-blue, SCSS).
- Testing: Karma + Jasmine.
- TypeScript: strict true.

## Quick commands (use these exact scripts)

- Dev: npm run start:dev (or npm start)
- Build: npm run build / npm run build:prod
- Lint: npm run lint (fix: npm run lint:fix)
- Format: npm run format (check: npm run format:check)
- Unit tests: npm test (CI: npm run test:ci, coverage: npm run test:coverage)

## Repo map (edit the right files)

- Bootstrap: src/main.ts uses bootstrapApplication(AppComponent, appConfig).
- App shell: src/app/app.component.* contains `<router-outlet>`.
- Global providers: src/app/app.config.ts (Router, Animations, HttpClientModule, Material modules, locale).
- Top-level routing: src/app/app.routes.ts.
- Feature routing: lazy-loaded *.module.ts under src/app/components/** using RouterModule.forChild(...).
- API base URL: src/environments/environment.ts and src/environments/environment.prod.ts (environment.baseUrl).
- HTTP / API access: src/app/services/task.service.ts.
- API contract reference: src/app/api/openapi.json.
- Global styles: src/styles.scss (Material + .error-snackbar).

## Existing architectural conventions (follow these)

- Standalone components: most components are standalone: true and declare their own Angular Material imports.
- Lazy loading pattern: routes load a feature NgModule (e.g. main-view.module.ts) that wires a path to a standalone component.
- Use generated openapi.json for API contract.
- Generate API service code with HeyAPI Generator.
- Base url is in environment.ts and environment.prod.ts.
- Error/toast UX: use MatSnackBar for user-visible errors/success. For “hard” errors, prefer panelClass: ['error-snackbar'].

## Formatting & linting rules

- Indentation: 2 spaces.
- Quotes: single quotes.
- Prettier: print width 100; trailing commas (es5).
- Keep imports clean; do not introduce unused imports (TS/ESLint is strict).
- Avoid adding comments unless explicitly requested.

## Safe change rules for agents

- Do not edit backend code or assume backend behavior beyond openapi.json.
- Do not add new dependencies (npm packages) unless explicitly requested.
- Do not change environment URLs unless explicitly asked; use environment*.ts when you must.
- Do not remove failing tests instead of fixing them unless explicitly asked.
- Prefer small, localized patches in existing files over large refactors.
- When adding a UI feature:
  - Use Angular Material components already used in the repo.
  - Add required Mat*Module imports to the standalone component imports array.
  - If creating a new route/page, add a lazy-loaded entry in app.routes.ts and a new feature *.module.ts under src/app/components/`<feature>`/.

## “How to proceed” checklist (agent workflow)

- First: search for existing patterns/components/services before creating new ones.
- Second: search for best practices online before creating new ones.
- Third: implement changes following the patterns in TaskService, TaskViewComponent, PlanItComponent, and dialogs.
- Fourth: run npm run lint and npm test (or at minimum npm run lint) after code changes.
- Fifth: ensure builds stay strict-TS compatible and no new lint violations are introduced.

## Testing Commands and Debugging (Angular 21 + Karma)

### Essential Test Commands

* npm test or ng test - Run tests in watch mode with Chrome
* npm run test:ci - Run tests once with ChromeHeadless (CI mode)
* npm run test:coverage - Run tests with coverage report

### Advanced Test Parameters for Debugging

* ng test --include="src/app/components/**/*.spec.ts" - Run only component tests
* ng test --include="src/app/services/**/*.spec.ts" - Run only service tests
* ng test --include="src/app/components/task-view/task-view.component.spec.ts" - Run single test file
* ng test --filter="TaskViewComponent" - Run tests matching pattern
* ng test --filter="should create" - Run tests with specific name pattern
* ng test --reporters=verbose - Detailed test output
* ng test --reporters=json --output-file=test-results.json - JSON output to file
* ng test --reporters=junit --output-file=test-results.xml - JUnit XML output
* ng test --no-watch --browsers=ChromeHeadless - CI-friendly single run
* ng test --list-tests - List all test files without running

### Recommended Debugging Workflow

* Identify failing tests: ng test --no-watch --browsers=ChromeHeadless --reporters=verbose
* Isolate specific test: ng test --include="path/to/failing.spec.ts" --no-watch --reporters=verbose
* Run single test pattern: ng test --filter="failing test name" --no-watch --reporters=verbose
* Get structured output: ng test --reporters=json --output-file=debug-results.json --no-watch
* Verify fix: ng test --include="path/to/test.spec.ts" --no-watch

### File Patterns

Component tests: `src/app/components/**/*.spec.ts`
Service tests: `src/app/services/**/*.spec.ts`
Guard tests: `src/app/guards/**/*.spec.ts`

### Important Notes

This project uses Angular 21 with Karma + Jasmine
Use --no-watch --browsers=ChromeHeadless for CI/automation
Karma HTML reporter available at `http://localhost:9876` during test runs
Coverage reports generated in `coverage/frontend/`

## MCP usage (when and how)

This environment provides MCP servers (notably `github-mcp-server` and `memory`).
Use them deliberately:

### `memory` (persist stable facts/preferences)

Use when saving:

- stable project invariants (e.g., “backend is FastAPI in [taskmanagement_app/](cci:7://file:///c:/Users/micro/CascadeProjects/Taskmanagement-App/taskmanagement_app:0:0-0:0)”, “Poetry commands”, “Windows PowerShell”)
- user preferences and non-negotiable rules (quality gates, no hallucinated paths, minimal diffs)
- decisions that should persist across tasks (chosen patterns, conventions)

Do not store:

- secrets or credentials (API keys, passwords, tokens, `.env` contents)
- transient state (temporary logs, current failing output, branch-specific details) unless explicitly requested and safe

Rule:

- Only store information that will still be true/valuable in future sessions.

### `git` (local repo operations)

Use for:

- read-only repo inspection: status, diff, log, blame, show, branch listing
- generating accurate summaries of changes and identifying impacted files

Safety rules:

- Prefer read-only operations by default.
- Any write action (add/commit/branch/checkout/reset) requires explicit user confirmation.
- Never rewrite history unless explicitly requested (no force-push, no rebase/amend by default).
- Before proposing a commit, ensure quality gates are expected to pass (black/isort/flake8/mypy/pytest).

### `github-mcp-server` (remote GitHub operations)

Use for:

- reading PRs/issues, release notes, CI status, reviewing diffs on GitHub
- drafting PR descriptions aligned with repo conventions and CI checks

Safety rules:

- Treat all network/remote actions as potentially sensitive.
- Do not create/modify issues, PRs, labels, branches, or secrets unless explicitly requested.
- Never paste tokens into chat, files, logs, or generated examples.
- Prefer least-privilege: only read what is needed to solve the task.

### `postman-api` (API collections/workspaces)

Use for:

- understanding existing API collections, examples, and test flows
- cross-checking request/response shapes against actual endpoints

Safety rules:

- Do not send secrets/tokens or real customer data in requests.
- Default to local URLs (localhost) for calls; ask before hitting non-local environments.
- If an API key is required, use environment variables and avoid writing it into repo files.
